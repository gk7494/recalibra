# Recalibra

Recalibra is a full-stack platform that monitors machine-learning models used in biotech labs. It ingests model predictions and experimental results, detects drift with statistical tests, and surfaces the findings on a React dashboard.

> This repository is intentionally simplified for local development and demos. The production-oriented scripts (AWS, MLflow, etc.) were removed; everything here works offline with SQLite and mock data sources.

---

## Contents
- [Architecture](#architecture)
- [Repository Layout](#repository-layout)
- [Prerequisites](#prerequisites)
- [Quick Start](#quick-start)
  - [Manual setup](#manual-setup)
  - [Docker Compose](#docker-compose)
- [Running Tests](#running-tests)
- [Seeding Demo Data](#seeding-demo-data)
- [API Reference](#api-reference)
- [Supporting Docs](#supporting-docs)

---

## Architecture
| Layer      | Stack / Notes                                                     |
|------------|--------------------------------------------------------------------|
| Backend    | FastAPI, SQLAlchemy, Pydantic, PostgreSQL/SQLite (dev uses SQLite) |
| Frontend   | React, TypeScript, Vite tooling, Plotly charts                     |
| Analytics  | NumPy, SciPy, scikit-learn (metrics + drift detection utilities)   |
| Workflow   | GitHub Actions CI (pytest, Docker builds, Vercel preview)          |

---

## Repository Layout
```
recalibra/
â”œâ”€â”€ backend/              # FastAPI application & services
â”‚   â”œâ”€â”€ app/core          # Config + DB session
â”‚   â”œâ”€â”€ app/api           # REST endpoints
â”‚   â”œâ”€â”€ app/services      # Metrics, drift, integrations
â”‚   â”œâ”€â”€ app/db            # SQLAlchemy models/session helpers
â”‚   â””â”€â”€ tests             # Pytest suite
â”œâ”€â”€ frontend/             # React dashboard (Vite + TypeScript)
â”œâ”€â”€ docs/                 # Additional setup notes & demo scripts
â”œâ”€â”€ sample_data/          # CSVs used for demo seeding
â”œâ”€â”€ sdk/                  # Lightweight Python client (optional)
â”œâ”€â”€ airflow/ & ml_pipeline/ (optional orchestration examples)
â””â”€â”€ docker-compose.yml    # Backend + database + frontend composition
```

Misc helper scripts (e.g. `start.sh`, `create_demo_data.py`) live at the repo root. They remain useful for demos and are documented in `docs/`.

---

## Prerequisites
- Python **3.10+** (3.11 recommended)
- Node.js **18+**
- npm or yarn
- Docker (optional, only required for the Compose workflow)

---

## Quick Start

### Manual setup
1. **Backend**
   ```bash
   cd backend
   python3 -m venv venv
   source venv/bin/activate  # Windows: venv\Scripts\activate
   pip install --upgrade pip
   pip install -r requirements.txt
   uvicorn app.main:app --reload
   ```
   The API is now available at http://localhost:8000 (docs at `/docs`).

2. **Frontend**
   ```bash
   cd frontend
   npm install
   npm run dev
   ```
   The dashboard runs at http://localhost:3000.

### Docker Compose
```bash
./start.sh         # spins up backend, frontend, and PostgreSQL
# ... or manually
# docker-compose up --build
```
Stop the stack with `docker-compose down` or `./stop-dev.sh`.

---

## Running Tests
Backend pytest suite (uses in-memory SQLite):
```bash
cd backend
python -m venv venv && source venv/bin/activate
pip install --upgrade pip
pip install -r requirements.txt pytest pytest-cov
pytest -q
```

Frontend tests (placeholder lint/build):
```bash
cd frontend
npm run build
```

CI mirrors the commands above and runs on every push/PR to `main`.

---

## Seeding Demo Data
Populate the database with realistic predictions + assay results and introduce controlled drift:
```bash
curl -X POST http://localhost:8000/api/sandbox/seed
```
Alternatively, run one of the helper scripts:
```bash
cd backend
python populate_complete_demo.py   # larger dataset
```

---

## API Reference
The autogenerated docs are available at http://localhost:8000/docs. Key endpoints:
- `GET /api/labs` â€” list labs
- `GET /api/models/{model_id}` â€” model details
- `GET /api/models/{model_id}/metrics` â€” RMSE, MAE, RÂ² grouped by week
- `GET /api/models/{model_id}/drift` â€” KS, PSI drift verdict
- `POST /api/datasets/{dataset_id}/upload` â€” ingest CSV of predictions/assays
- `POST /api/sandbox/seed` â€” seed demo data

---

## Supporting Docs
Additional scripts and walkthroughs live inside `docs/`:
- `docs/QUICKSTART.md` â€” extended local setup
- `docs/SETUP.md` & `docs/SETUP_INSTRUCTIONS.md` â€” background context
- `docs/GITHUB_SETUP.md` â€” GitHub configuration notes

---

Made with ðŸ§¬ for teams that need to keep laboratory ML models in check.
